<!DOCTYPE html>
<!-- This site was created with Wowchemy. https://www.wowchemy.com -->
<!-- Last Published: October 3, 2023 --><html lang="en-us" >


<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  
  
  
    <meta name="generator" content="Wowchemy 5.7.0 for Hugo" />
  

  
  












  
  










  







  
  
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  

  
  
  
    
      
      <link rel="preload" as="style" href="https://fonts.googleapis.com/css2?family=Noto+Serif+Georgian:wght@400;700&family=Roboto+Mono&display=swap">
      <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Noto+Serif+Georgian:wght@400;700&family=Roboto+Mono&display=swap" media="print" onload="this.media='all'">
    
  

  
  

  
  

  

  <link rel="stylesheet" href="/css/vendor-bundle.min.047268c6dd09ad74ba54a0ba71837064.css" media="print" onload="this.media='all'">

  
  
  
    
    
      <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/academicons@1.9.2/css/academicons.min.css" integrity="sha512-KlJCpRsLf+KKu2VQa5vmRuClRFjxc5lXO03ixZt82HZUk41+1I0bD8KBSA0fY290ayMfWYI9udIqeOWSu1/uZg==" crossorigin="anonymous" media="print" onload="this.media='all'">
    

    
    
    
    
      
      
    
    
    

    
    
    

    

    
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
      
      

      
      
        
      

      
    
      
      

      
      

      
    
      
      

      
      

      
    
  

  
  
  
  
  
  
  <link rel="stylesheet" href="/css/wowchemy.19ace57e8fb59446025b8bf3d7d5865c.css" />

  
  
  

  
  
  
  
  
  
  
    
    
    <link rel="stylesheet" href="/css/libs/chroma/github-light.min.css" title="hl-light" media="print" onload="this.media='all'" >
    <link rel="stylesheet" href="/css/libs/chroma/dracula.min.css" title="hl-dark" media="print" onload="this.media='all'" disabled>
  

  
  


























  
  
  






  <meta name="author" content="Yuhao Zhang" />





  

<meta name="description" content="This thrust studies the increasingly important problem of ensuring the correctness of deep learning training and inference codes built on top of TensorFlow/PyTorch. Deep learning models have made remarkable advancements in solving complex and diverse problems." />



<link rel="alternate" hreflang="en-us" href="https://foreverzyh.github.io/project/project_3/" />
<link rel="canonical" href="https://foreverzyh.github.io/project/project_3/" />



  <link rel="manifest" href="/manifest.webmanifest" />



<link rel="icon" type="image/png" href="/media/icon_hua00f88fad60b7868af5bfc9120ceaf0a_569795_32x32_fill_lanczos_center_3.png" />
<link rel="apple-touch-icon" type="image/png" href="/media/icon_hua00f88fad60b7868af5bfc9120ceaf0a_569795_180x180_fill_lanczos_center_3.png" />

<meta name="theme-color" content="#ac060b" />










  
  






<meta property="twitter:card" content="summary" />
<meta property="twitter:image" content="https://foreverzyh.github.io/media/icon_hua00f88fad60b7868af5bfc9120ceaf0a_569795_512x512_fill_lanczos_center_3.png" />
<meta property="og:site_name" content="Yuhao Zhang (张煜皓)" />
<meta property="og:url" content="https://foreverzyh.github.io/project/project_3/" />
<meta property="og:title" content="Correctness of Codes using Deep Learning Platforms | Yuhao Zhang (张煜皓)" />
<meta property="og:description" content="This thrust studies the increasingly important problem of ensuring the correctness of deep learning training and inference codes built on top of TensorFlow/PyTorch. Deep learning models have made remarkable advancements in solving complex and diverse problems." /><meta property="og:image" content="https://foreverzyh.github.io/media/icon_hua00f88fad60b7868af5bfc9120ceaf0a_569795_512x512_fill_lanczos_center_3.png" /><meta property="og:locale" content="en-us" />

  
    <meta
      property="article:published_time"
      content="2023-09-01T00:00:00&#43;00:00"
    />
  
  
    <meta property="article:modified_time" content="2023-09-01T00:00:00&#43;00:00">
  






    









<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Article",
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://foreverzyh.github.io/project/project_3/"
  },
  "headline": "Correctness of Codes using Deep Learning Platforms",
  
  "datePublished": "2023-09-01T00:00:00Z",
  "dateModified": "2023-09-01T00:00:00Z",
  
  "author": {
    "@type": "Person",
    "name": "Yuhao Zhang"
  },
  
  "publisher": {
    "@type": "Organization",
    "name": "Yuhao Zhang (张煜皓)",
    "logo": {
      "@type": "ImageObject",
      "url": "https://foreverzyh.github.io/media/icon_hua00f88fad60b7868af5bfc9120ceaf0a_569795_192x192_fill_lanczos_center_3.png"
    }
  },
  "description": "This thrust studies the increasingly important problem of ensuring the correctness of deep learning training and inference codes built on top of TensorFlow/PyTorch. Deep learning models have made remarkable advancements in solving complex and diverse problems."
}
</script>

  

  




  
  
  

  
  

  


  
  <title>Correctness of Codes using Deep Learning Platforms | Yuhao Zhang (张煜皓)</title>

  
  
  
  











</head>


<body id="top" data-spy="scroll" data-offset="70" data-target="#TableOfContents" class="page-wrapper   " data-wc-page-id="482b03b1cd1950497ab767037c9acf41" >

  
  
  
  
  
  
  
  
  
  <script src="/js/wowchemy-init.min.fe8634e7d00f14d07fb33caf14cc8e55.js"></script>

  




  <div class="page-header header--fixed">
  
  
  
  
  












<header>
  <nav class="navbar navbar-expand-lg navbar-light compensate-for-scrollbar" id="navbar-main">
    <div class="container-xl">

      
      <div class="d-none d-lg-inline-flex">
        <a class="navbar-brand" href="/">Yuhao Zhang (张煜皓)</a>
      </div>
      

      
      <button type="button" class="navbar-toggler" data-toggle="collapse"
              data-target="#navbar-content" aria-controls="navbar-content" aria-expanded="false" aria-label="Toggle navigation">
      <span><i class="fas fa-bars"></i></span>
      </button>
      

      
      <div class="navbar-brand-mobile-wrapper d-inline-flex d-lg-none">
        <a class="navbar-brand" href="/">Yuhao Zhang (张煜皓)</a>
      </div>
      

      
      
      <div class="navbar-collapse main-menu-item collapse justify-content-end" id="navbar-content">

        
        <ul class="navbar-nav d-md-inline-flex">
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#about"><span>Home</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#projects"><span>Research</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#featured"><span>Publications</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#awards"><span>Awards</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#services"><span>Services</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#others"><span>Personal</span></a>
          </li>

          
          

          

          
          
          
            
          

          

          
          
          
          

          
            
              
              
            
            
              
              
              
                
              
              
            
          

          <li class="nav-item">
            <a class="nav-link " href="/#contact"><span>Contact</span></a>
          </li>

          
          

        

          
        </ul>
      </div>

      <ul class="nav-icons navbar-nav flex-row ml-auto d-flex pl-md-2">

        
        
          
        

        
        
        

        
        
        

        
        

      </ul>

    </div>
  </nav>
</header>


  </div>

  <div class="page-body">
    
    
    

    <article class="article article-project">

  













  

  
  
  
<div class="article-container pt-3">
  <h1>Correctness of Codes using Deep Learning Platforms</h1>

  

  
    


<div class="article-metadata">

  
  

  
  <span class="article-date">
    
    
      
    
    Sep 1, 2023
  </span>
  

  

  

  
  
  
  

  
  

</div>

    





  
</div>



  <div class="article-container">

    <div class="article-style">
      <h4>This thrust studies the increasingly important problem of ensuring the correctness of deep learning training and inference codes built on top of TensorFlow/PyTorch.</h4>
<p>Deep learning models have made remarkable advancements in solving complex and diverse problems.
These models manifest as training and inference codes developed on platforms like TensorFlow and PyTorch.
These codes require a programming paradigm that differs significantly from traditional ones.
As a result, new defects have emerged in deep learning codes, and we need to rethink the problem of verifying the correctness of these codes and providing provable fixes to these defects.</p>
<p>In my research on the provable guarantees for the correctness of deep learning codes, I ask: <em>What are these new defects of deep learning codes? Detecting and fixing which brings the largest benefit to the deep learning community?</em>
The first question leads me to conduct a pioneering empirical study of novel defects in deep learning codes.
The second question guides my work on ensuring deep learning codes are free of <em>numerical defects</em>, which often manifest as <code>NaN</code> or <code>INF</code> during the computation of neural networks.
These defects, which widely exist in deep learning codes, significantly impair the model&rsquo;s effectiveness and may lead to system crashes.</p>
<div style="display: flex; justify-content: center; align-items: center;">
<figure>
  <img src="/uploads/code_debar.png" alt="DEBAR" style="width:100%; padding: 10px;">
  <figcaption>DEBAR: A static analyzer over the computational graph.</figcaption>
</figure>
<figure>
  <img src="/uploads/code_ranum.png" alt="RANUM" style="width:100%; padding: 10px;">
  <figcaption>RANUM: A framework for reliability assurance.</figcaption>
</figure>
</div>
<p><strong>Papers:</strong> <a href="/uploads/An%20Empirical%20Study%20on%20TensorFlow%20Program%20Bugs-issta18.pdf">A empirical study (ISSTA2018)</a>, <a href="/uploads/Detecting%20Numerical%20Bugs%20in%20Neural%20Network%20Architectures-esec-fse20.pdf">DEBAR (FSE2020)</a>, <a href="http://linyil.com/res/pub/ICSE_2023_li_reliability.pdf" target="_blank" rel="noopener">RANUM (ICSE2023)</a></p>
<p><strong>Key ideas:</strong></p>
<ol>
<li>A pioneering empirical study of defects in deep learning codes.</li>
<li>Abstract interpretation techniques for verifying deep learning codes without numerical defects.</li>
<li>A framework for reliability assurance for deep learning codes against numerical defects by providing failure-exhibiting tests and provable fix suggestions.</li>
</ol>
<p><strong>A pioneering empirical study</strong>
Motivated by the need to study emerging defects in deep learning codes, I conducted a pioneering empirical study on the root causes, symptoms, and fixing strategies of these new defects.
This empirical study not only serves as a bedrock of my work in this thrust but also inspires a multitude of endeavors in the research community,
e.g., approaches for detecting new defects identified by our study, refinement of our taxonomy and extension to deep learning system in general.</p>
<p><strong>Verification of the absence of numerical defects</strong>
My work, DEBAR, aims to detect numerical defects in deep learning codes.
It achieves this by either constructing a proof demonstrating the absence of numerical defects within the codes or identifying suspicious computational graph nodes that may potentially have numerical defects.
To construct such proof, we design refined yet scalable abstract domains, <em>tensor partitioning</em> and <em>interval with affine equality relation</em>, to over-approximate the output range of each node in the computational graph, representing the deep learning code.
If a node receives an invalid range or its output overflows, we will report this node as suspicious. And if no such node exists in the code, we then get a correctness proof owing to the soundness of abstract interpretation.
DEBAR has been applied to deep learning code maintained by TensorFlow and successfully detected numerical defects in them (<a href="https://github.com/tensorflow/models/pull/8221" target="_blank" rel="noopener">defect 1</a>, <a href="https://github.com/tensorflow/models/pull/8223" target="_blank" rel="noopener">defect 2</a>).</p>
<p><strong>Provable fixes to numerical defects</strong>
Once the defects are exposed, developers need to fix these defects. However, we found that developers either provide no fixes or heuristic fixes that do not eliminate these defects, such as reducing the learning rate.
Therefore, our work, RANUM, aims to synthesize provable fixes to these defects for developers automatically.
We apply interval preconditions to clipping the range of defective nodes in the computational graph.
Striking the right balance with these interval preconditions is critical; if the preconditions are overly strong, they can hinder the model&rsquo;s performance, whereas if they are too weak, they may still result in numerical defects.
We propose an abstraction optimization algorithm to find the weakest precondition that provably eliminates the defects.</p>

    </div>

    

















  
  



  
  
  
    
  
  
  
  <div class="media author-card content-widget-hr">
    
      
      <a href="https://foreverzyh.github.io"><img class="avatar mr-3 avatar-circle" src="/authors/admin/avatar_hu01e4ec326c50cd7aefc985dadaf9dbf8_162764_270x270_fill_q75_lanczos_center.jpg" alt="Yuhao Zhang"></a>
    

    <div class="media-body">
      <h5 class="card-title"><a href="https://foreverzyh.github.io">Yuhao Zhang</a></h5>
      <h6 class="card-subtitle">Ph.D. student in Computer Science</h6>
      
      <ul class="network-icon" aria-hidden="true">
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="/#contact" >
        <i class="fas fa-envelope"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="https://scholar.google.com/citations?user=0Nt2bGUAAAAJ&amp;hl=en&amp;authuser=1" target="_blank" rel="noopener">
        <i class="ai ai-google-scholar"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://github.com/ForeverZyh" target="_blank" rel="noopener">
        <i class="fab fa-github"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://www.linkedin.com/in/yuhaoz/" target="_blank" rel="noopener">
        <i class="fab fa-linkedin"></i>
      </a>
    </li>
  
    
    
    
    
    
    
    
      
    
    <li>
      <a href="/uploads/CV_general.pdf" >
        <i class="ai ai-cv"></i>
      </a>
    </li>
  
    
    
    
      
    
    
    
    
    
      
    
    <li>
      <a href="https://twitter.com/YuhaoZhang16" target="_blank" rel="noopener">
        <i class="fab fa-twitter"></i>
      </a>
    </li>
  
</ul>

    </div>
  </div>


















    <div class="project-related-pages content-widget-hr">
      
      

      
      
      

      
      
      

      
      
      
    </div>
  </div>
</article>
  </div>

  <div class="page-footer">
    
    
    <div class="container">
      <footer class="site-footer">

  












  
  
  
  
  













  
  <p class="powered-by copyright-license-text">
    © 2023 Yuhao Zhang.
  </p>
  





  <p class="powered-by">
    
    
    
      
      
      
      
      
      
      Published with <a href="https://wowchemy.com/?utm_campaign=poweredby" target="_blank" rel="noopener">Wowchemy</a> — the free, <a href="https://github.com/wowchemy/wowchemy-hugo-themes" target="_blank" rel="noopener">open source</a> website builder that empowers creators.
    
  </p>
</footer>

    </div>
    
  </div>

  


<script src="/js/vendor-bundle.min.f64289d8217e08e3afcd597d60836062.js"></script>




  

  
  

  








































<script id="page-data" type="application/json">{"use_headroom":true}</script>


  <script src="/js/wowchemy-headroom.db4755770454eb63685f8de785c0a172.js" type="module"></script>










<script src="/en/js/wowchemy.min.387a7b38a3dfead6f96c96742d20f5af.js"></script>







  
<div id="modal" class="modal fade" role="dialog">
  <div class="modal-dialog">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title">Cite</h5>
        <button type="button" class="close" data-dismiss="modal" aria-label="Close">
          <span aria-hidden="true">&times;</span>
        </button>
      </div>
      <div class="modal-body">
        
        <pre><code></code></pre>
      </div>
      <div class="modal-footer">
        <a class="btn btn-outline-primary my-1 js-copy-cite" href="#" target="_blank">
          <i class="fas fa-copy"></i> Copy
        </a>
        <a class="btn btn-outline-primary my-1 js-download-cite" href="#" target="_blank">
          <i class="fas fa-download"></i> Download
        </a>
        <div id="modal-error"></div>
      </div>
    </div>
  </div>
</div>


  <script src="/js/wowchemy-publication.68f8d7090562ca65fc6d3cb3f8f2d2cb.js" type="module"></script>


















</body>
</html>
